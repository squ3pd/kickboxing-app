// –ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞ –¥–ª—è Telegram –±–æ—Ç–∞ (Node.js)
// –í–ê–ñ–ù–û: –≠—Ç–æ—Ç —Ñ–∞–π–ª –ù–ï –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω –¥–ª—è —Ä–∞–±–æ—Ç—ã Mini App!
// Mini App —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ BotFather –Ω–∞—Å—Ç—Ä–æ–π–∫–∏.
// –≠—Ç–æ—Ç —Ñ–∞–π–ª –Ω—É–∂–µ–Ω —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –¥–æ–±–∞–≤–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é –ª–æ–≥–∏–∫—É –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ.

// –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: npm install node-telegram-bot-api

const TelegramBot = require('node-telegram-bot-api');

// –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à —Ç–æ–∫–µ–Ω –æ—Ç BotFather
const token = 'YOUR_BOT_TOKEN_HERE';

// –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ URL –≤–∞—à–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
const APP_URL = 'https://your-app-url.com';

// –°–æ–∑–¥–∞–µ–º –±–æ—Ç–∞
const bot = new TelegramBot(token, { polling: true });

// –ö–æ–º–∞–Ω–¥–∞ /start
bot.onText(/\/start/, (msg) => {
    const chatId = msg.chat.id;
    const options = {
        reply_markup: {
            inline_keyboard: [
                [
                    {
                        text: 'üì± –û—Ç–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ',
                        web_app: { url: APP_URL }
                    }
                ]
            ]
        }
    };
    
    bot.sendMessage(
        chatId,
        'üëã –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ —Å–∏—Å—Ç–µ–º—É —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∏ –∞–Ω–∞–ª–∏–∑–∞ —Ñ–∏–∑–∏—á–µ—Å–∫–∏—Ö –Ω–∞–≥—Ä—É–∑–æ–∫ –≤ –∫–∏–∫–±–æ–∫—Å–∏–Ω–≥–µ!\n\n' +
        'üìä –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:\n' +
        '‚Ä¢ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–ø–æ—Ä—Ç—Å–º–µ–Ω–∞–º–∏\n' +
        '‚Ä¢ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫\n' +
        '‚Ä¢ –¢–∞–±–ª–∏—Ü–∞ –Ω–æ—Ä–º–∞—Ç–∏–≤–æ–≤\n' +
        '‚Ä¢ –ê–Ω–∞–ª–∏–∑ –Ω–∞–≥—Ä—É–∑–æ–∫\n\n' +
        '–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ, —á—Ç–æ–±—ã –æ—Ç–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ.',
        options
    );
});

// –ö–æ–º–∞–Ω–¥–∞ /help
bot.onText(/\/help/, (msg) => {
    const chatId = msg.chat.id;
    bot.sendMessage(
        chatId,
        'üìñ –ü–æ–º–æ—â—å –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é:\n\n' +
        '1. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "–û—Ç–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ" –¥–ª—è –∑–∞–ø—É—Å–∫–∞\n' +
        '2. –î–æ–±–∞–≤—å—Ç–µ —Å–ø–æ—Ä—Ç—Å–º–µ–Ω–æ–≤ —á–µ—Ä–µ–∑ —Ä–∞–∑–¥–µ–ª "–°–ø–æ—Ä—Ç—Å–º–µ–Ω—ã"\n' +
        '3. –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ —Å —É–∫–∞–∑–∞–Ω–∏–µ–º —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π\n' +
        '4. –í–≤–æ–¥–∏—Ç–µ –Ω–æ—Ä–º–∞—Ç–∏–≤—ã –≤ —Ç–∞–±–ª–∏—Ü–µ –Ω–æ—Ä–º–∞—Ç–∏–≤–æ–≤\n' +
        '5. –ü—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞–π—Ç–µ –∏—Ç–æ–≥–æ–≤—ã–µ —Ä–∞—Å—á–µ—Ç—ã\n\n' +
        'üí° –í—Å–µ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ –≤ –≤–∞—à–µ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ.'
    );
});

// –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ Mini App (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –¥–∞–Ω–Ω—ã–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä)
bot.on('message', (msg) => {
    if (msg.web_app_data) {
        try {
            const data = JSON.parse(msg.web_app_data.data);
            console.log('–ü–æ–ª—É—á–µ–Ω—ã –¥–∞–Ω–Ω—ã–µ –∏–∑ Mini App:', data);
            // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –¥–∞–Ω–Ω—ã–µ, —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –ë–î –∏ —Ç.–¥.
            bot.sendMessage(msg.chat.id, '‚úÖ –î–∞–Ω–Ω—ã–µ –ø–æ–ª—É—á–µ–Ω—ã –∏ –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã!');
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö:', error);
        }
    }
});

console.log('ü§ñ –ë–æ—Ç –∑–∞–ø—É—â–µ–Ω!');
console.log(`üì± Mini App URL: ${APP_URL}`);
console.log('üí° –î–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Mini App –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É /newapp –≤ @BotFather');

