# Иерархическая статистика по периодам

## Как работает статистика

Статистика теперь работает по принципу иерархической агрегации:

### Уровни иерархии:

1. **День** (базовый уровень)
   - Все тренировки одного дня группируются вместе
   - Вычисляется общая статистика дня

2. **Неделя** (агрегация дней)
   - Дни группируются в недели (понедельник - воскресенье)
   - Статистика недели = сумма статистик всех дней недели
   - Средние значения вычисляются на основе дней

3. **Месяц** (агрегация недель)
   - Недели группируются в месяцы
   - Статистика месяца = сумма статистик всех недель месяца
   - Средние значения вычисляются на основе недель

4. **Квартал/Сезон** (агрегация месяцев)
   - Месяцы группируются в кварталы (3 месяца)
   - Кварталы также привязаны к сезонам:
     - 1 квартал (Январь-Март) = Зима
     - 2 квартал (Апрель-Июнь) = Весна
     - 3 квартал (Июль-Сентябрь) = Лето
     - 4 квартал (Октябрь-Декабрь) = Осень
   - Статистика квартала = сумма статистик всех месяцев квартала

## Пример работы:

### День 1 (01.12.2024):
- Тренировка 1: ОФП 30 мин, ЧСС 120
- Тренировка 2: СПУ 20 мин, ЧСС 150
- **Итого дня:** 50 мин, 2 тренировки, средний ЧСС 135

### День 2 (02.12.2024):
- Тренировка 1: УС 25 мин, ЧСС 140
- **Итого дня:** 25 мин, 1 тренировка, средний ЧСС 140

### Неделя (25.11 - 01.12.2024):
- День 1: 50 мин, 2 тренировки
- День 2: 25 мин, 1 тренировка
- День 3: 40 мин, 2 тренировки
- ...
- **Итого недели:** 115 мин, 5 тренировок, средний ЧСС (вычисляется из дней)

### Месяц (Декабрь 2024):
- Неделя 1: 115 мин, 5 тренировок
- Неделя 2: 180 мин, 8 тренировок
- Неделя 3: 200 мин, 9 тренировок
- Неделя 4: 150 мин, 7 тренировок
- **Итого месяца:** 645 мин, 29 тренировок, средний ЧСС (вычисляется из недель)

### Квартал (4 квартал 2024 - Осень):
- Октябрь: 600 мин, 25 тренировок
- Ноябрь: 650 мин, 28 тренировок
- Декабрь: 645 мин, 29 тренировок
- **Итого квартала:** 1895 мин, 82 тренировки, средний ЧСС (вычисляется из месяцев)

## Что отображается:

1. **Кварталы/Сезоны** - самый высокий уровень
   - Показывает, из скольких месяцев состоит
   - Общая статистика за квартал

2. **Месяцы** - средний уровень
   - Показывает, из скольких недель состоит
   - Общая статистика за месяц

3. **Недели** - нижний уровень
   - Показывает, из скольких дней состоит
   - Общая статистика за неделю
   - Отображаются последние 12 недель

## Преимущества иерархической системы:

✅ **Точность** - статистика вычисляется последовательно от меньших периодов к большим
✅ **Прозрачность** - видно, из чего состоит каждый период
✅ **Гибкость** - можно легко добавить новые уровни (полугодие, год)
✅ **Логичность** - соответствует естественному пониманию времени

